---
title: "scores_all"
author: "Suzanne Clougher"
date: "4 mai 2021"
output: html_document
---

```{r}
library(haven)
library(tidyverse)
library(readxl)
```

# Datasets-----------------------------------------------------------------------
```{r}
# Food data
alim <- read_sas("frjour.sas7bdat")

# Breastfeeding data
bfeed <- read_sas("d_grossesse_20190107_corrections.sas7bdat") %>% rename(ident = IDENT)

# Physical activity data 
physact <- read_sas("physicalact.sas7bdat") %>% rename(ident = IDENT)

# Correspondence ident-COBBMB
id <- read_xls("E3N_cancer du sein_21072014.xls") %>% mutate(ident = IDENT) %>% select(c("CODBMB", "ident"))

# Fiber data
fiber <- read_sas("nut_fra2.sas7bdat") %>% select(ident, alcool, FIBR, SDF, TDF)

# Metadata
meta <- read_csv("metadata.csv", na = "9999")
meta$CODBMB <- as.character(meta$CODBMB)
```

```{r}
# Extract controls from metadata and create a single table
scoredata <- meta %>% 
  left_join(id, by = "CODBMB") %>% left_join(alim, by = "ident") %>%
  left_join(fiber, by = "ident") %>% left_join(bfeed, by = "ident") %>%
  left_join(physact, by = "ident")

scoredataCTR <- meta %>% 
  filter(CT == 0) %>% 
  left_join(id, by = "CODBMB") %>% left_join(alim, by = "ident") %>%
  left_join(fiber, by = "ident") %>% left_join(bfeed, by = "ident") %>%
  left_join(physact, by = "ident")

scoredataCS <- meta %>% 
  filter(CT == 1) %>% 
  left_join(id, by = "CODBMB") %>% left_join(alim, by = "ident") %>%
  left_join(fiber, by = "ident") %>% left_join(bfeed, by = "ident") %>%
  left_join(physact, by = "ident")

```


# Manipulating data for score -----------------------------------------------------------------------

```{r}
#Renaming all (food) columns starting with "_" 
data_xnames <- scoredata %>%
  rename_at(vars(starts_with('_')), funs(str_replace(., '_', 'x'))) 

data_xnamesCTR <- scoredataCTR %>%
  rename_at(vars(starts_with('_')), funs(str_replace(., '_', 'x'))) 

data_xnamesCS <- scoredataCS %>%
  rename_at(vars(starts_with('_')), funs(str_replace(., '_', 'x'))) 
```

```{r}
#Calculating g/day intake of total fruits & vegetables, red meat, processed meat, drinks, alcohol, aUPF, total food intake and percentage of aUPF in total food intake
data_xnames_sums <- data_xnames %>%
  rowwise() %>%
  mutate (fruitveg = sum(x2, x3, x35, x40, x53)/7, #g/day
          Rmeat = sum(x46_3, x46_4, x46_6, x46_7, x46_9, x47_2), #g/week
          Pmeat = sum(x19, x36, x37, x41_4, x41_7, x42, x47_6), #g/week
          sugary_drinks = sum(x7, x21)/7, #g/day
          alcohol = (sum(x25, x26, x27, x28, x29, x30, x31, x58) - x25_3)/7,
          aUPF = sum(x10_4, x10_7, x11_2, x11_3, x11_5, x11_6, x14, x15, x16_3, x16_4, 
                     x16_5, x16_6, x17_4, x17_5, x17_6, x22, x23, x24, x33, x47_1, 
                     x47_5, x47_8, x48, x50, x54, x55, x56, x57, 
                     MG2, MG3, MG4, MG12, MG15, VIN1, VIN2)/7, #g/day
          total_food = 
            sum(x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, 
                x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x26, x27, x28, 
                x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39, x40, x41, 
                x42, x43, x44, x45, x46, x47, x49, x50, x51, x52, x53, x54, 
                x55, x58, x59, 
                SUCRE, EDULC, LAIT, VIN, MG)/7) %>% #g/day
  mutate (percent_aUPF = (aUPF/total_food) *100) #percent of aUPF in total food intake (g/day)

data_xnames_sumsCTR <- data_xnamesCTR %>%
  rowwise() %>%
  mutate (fruitveg = sum(x2, x3, x35, x40, x53)/7, #g/day
          Rmeat = sum(x46_3, x46_4, x46_6, x46_7, x46_9, x47_2), #g/week
          Pmeat = sum(x19, x36, x37, x41_4, x41_7, x42, x47_6), #g/week
          sugary_drinks = sum(x7, x21)/7, #g/day
          alcohol = (sum(x25, x26, x27, x28, x29, x30, x31, x58) - x25_3)/7,
          aUPF = sum(x10_4, x10_7, x11_2, x11_3, x11_5, x11_6, x14, x15, x16_3, x16_4, 
                     x16_5, x16_6, x17_4, x17_5, x17_6, x22, x23, x24, x33, x47_1, 
                     x47_5, x47_8, x48, x50, x54, x55, x56, x57, 
                     MG2, MG3, MG4, MG12, MG15, VIN1, VIN2)/7, #g/day
          total_food = 
            sum(x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, 
                x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x26, x27, x28, 
                x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39, x40, x41, 
                x42, x43, x44, x45, x46, x47, x49, x50, x51, x52, x53, x54, 
                x55, x58, x59, 
                SUCRE, EDULC, LAIT, VIN, MG)/7) %>% #g/day
  mutate (percent_aUPF = (aUPF/total_food) *100) #percent of aUPF in total food intake (g/day)

data_xnames_sumsCS <- data_xnamesCS %>%
  rowwise() %>%
  mutate (fruitveg = sum(x2, x3, x35, x40, x53)/7, #g/day
          Rmeat = sum(x46_3, x46_4, x46_6, x46_7, x46_9, x47_2), #g/week
          Pmeat = sum(x19, x36, x37, x41_4, x41_7, x42, x47_6), #g/week
          sugary_drinks = sum(x7, x21)/7, #g/day
          alcohol = (sum(x25, x26, x27, x28, x29, x30, x31, x58) - x25_3)/7,
          aUPF = sum(x10_4, x10_7, x11_2, x11_3, x11_5, x11_6, x14, x15, x16_3, x16_4, 
                     x16_5, x16_6, x17_4, x17_5, x17_6, x22, x23, x24, x33, x47_1, 
                     x47_5, x47_8, x48, x50, x54, x55, x56, x57, 
                     MG2, MG3, MG4, MG12, MG15, VIN1, VIN2)/7, #g/day
          total_food = 
            sum(x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, 
                x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x26, x27, x28, 
                x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39, x40, x41, 
                x42, x43, x44, x45, x46, x47, x49, x50, x51, x52, x53, x54, 
                x55, x58, x59, 
                SUCRE, EDULC, LAIT, VIN, MG)/7) %>% #g/day
  mutate (percent_aUPF = (aUPF/total_food) *100) #percent of aUPF in total food intake (g/day)
```

```{r}
#Cleaning missing data in percentage of aUPF, breastfeeding and waist circumference
clean_data <- data_xnames_sums %>% 
  filter(!is.na(percent_aUPF) & !is.na(allaitement_dureecum) & !is.na(TTAILLE))
clean_dataCTR <- data_xnames_sumsCTR %>% 
  filter(!is.na(percent_aUPF) & !is.na(allaitement_dureecum) & !is.na(TTAILLE))
clean_dataCS <- data_xnames_sumsCS %>% 
  filter(!is.na(percent_aUPF) & !is.na(allaitement_dureecum) & !is.na(TTAILLE))
```

```{r}
#Tertiles : needed for aUPF consumption cutoff points
tertiles_UPF <- quantile(clean_data$percent_aUPF, probs = c(1/3, 2/3))
tertile_UPF1 <- as.numeric(tertiles_UPF[1]) #cut point n°1 (fully-met recommendation)
tertile_UPF2 <- as.numeric(tertiles_UPF[2]) #cut point n°2 (half-met recommendation)

tertiles_UPF_CTR <- quantile(clean_dataCTR$percent_aUPF, probs = c(1/3, 2/3))
tertile_UPF1_CTR <- as.numeric(tertiles_UPF_CTR[1]) #cut point n°1 (fully-met recommendation)
tertile_UPF2_CTR <- as.numeric(tertiles_UPF_CTR[2]) #cut point n°2 (half-met recommendation)

tertiles_UPF_CS <- quantile(clean_dataCS$percent_aUPF, probs = c(1/3, 2/3))
tertile_UPF1_CS <- as.numeric(tertiles_UPF_CS[1]) #cut point n°1 (fully-met recommendation)
tertile_UPF2_CS <- as.numeric(tertiles_UPF_CS[2]) #cut point n°2 (half-met recommendation)
```


# Score -----------------------------------------------------------------------

```{r}
df.scores <- clean_data %>% 
  mutate(sc.BMI1 = ifelse(BMI > 18.5 & BMI < 30, 0.25, 0), # At least 0.25 for this condition
         sc.BMI2 = ifelse(BMI > 18.5 & BMI < 25, 0.25, 0), # Another 0.25 for this condition
         sc.TT1  = ifelse(TTAILLE < 88, 0.25, 0), 
         sc.TT2  = ifelse(TTAILLE < 80, 0.25, 0),
         sc.PA1  = ifelse(TotalAPQ3 > 9.375, 0.5, 0), 
         sc.PA2  = ifelse(TotalAPQ3 > 18.75, 0.5, 0),
         sc.FV1 = ifelse(fruitveg > 200, 0.5, 0),
         sc.FV2 = ifelse(fruitveg > 400, 0.5, 0),
         sc.TDF1 = ifelse(TDF > 15, 0.5, 0),
         sc.TDF2 = ifelse(TDF > 30, 0.5, 0),
         sc.UPF1 = ifelse(percent_aUPF < tertile_UPF2, 0.5, 0),
         sc.UPF2 = ifelse(percent_aUPF < tertile_UPF1, 0.5, 0),
         sc.MEAT1 = ifelse(Rmeat < 500 & Pmeat < 100, 0.5, 0),
         sc.MEAT2 = ifelse(Rmeat < 500 & Pmeat < 21, 0.5, 0),
         sc.SD1 = ifelse(sugary_drinks < 250, 0.5, 0),
         sc.SD2 = ifelse(sugary_drinks == 0, 0.5, 0),
         sc.ALC1 = ifelse(alcohol < 14, 0.5, 0),
         sc.ALC2 = ifelse(alcohol == 0, 0.5, 0),
         sc.BFD1 = ifelse(nullipare == 0 & allaitement_dureecum > 0 & allaitement_dureecum < 6, 0.5, 0),
         sc.BFD2 = ifelse(nullipare == 0 & allaitement_dureecum > 6, 0.5, 0),
         # Add up sc.BMI + sc.TT + sc.PA + other recommendations to get score         
         sc.BMI = sc.BMI1 + sc.BMI2, sc.TT = sc.TT1 + sc.TT2, sc.PA = sc.PA1 + sc.PA2,
         sc.FV = sc.FV1 + sc.FV2, sc.TDF = sc.TDF1 + sc.TDF2, sc.UPF= sc.UPF1 + sc.UPF2, sc.MEAT = sc.MEAT1 + sc.MEAT2,
         sc.SD = sc.SD1 + sc.SD2, sc.ALC = sc.ALC1 + sc.ALC2,
         sc.BFD = sc.BFD1 + sc.BFD2,
         # Get overall score
         score = sc.BMI + sc.TT + sc.PA + sc.FV + sc.TDF + sc.UPF + sc.MEAT + sc.SD + sc.ALC + sc.BFD)

df.scoresCTR <- clean_dataCTR %>% 
  mutate(sc.BMI1 = ifelse(BMI > 18.5 & BMI < 30, 0.25, 0), # At least 0.25 for this condition
         sc.BMI2 = ifelse(BMI > 18.5 & BMI < 25, 0.25, 0), # Another 0.25 for this condition
         sc.TT1  = ifelse(TTAILLE < 88, 0.25, 0), 
         sc.TT2  = ifelse(TTAILLE < 80, 0.25, 0),
         sc.PA1  = ifelse(TotalAPQ3 > 9.375, 0.5, 0), 
         sc.PA2  = ifelse(TotalAPQ3 > 18.75, 0.5, 0),
         sc.FV1 = ifelse(fruitveg > 200, 0.5, 0),
         sc.FV2 = ifelse(fruitveg > 400, 0.5, 0),
         sc.TDF1 = ifelse(TDF > 15, 0.5, 0),
         sc.TDF2 = ifelse(TDF > 30, 0.5, 0),
         sc.UPF1 = ifelse(percent_aUPF < tertile_UPF2_CTR, 0.5, 0),
         sc.UPF2 = ifelse(percent_aUPF < tertile_UPF1_CTR, 0.5, 0),
         sc.MEAT1 = ifelse(Rmeat < 500 & Pmeat < 100, 0.5, 0),
         sc.MEAT2 = ifelse(Rmeat < 500 & Pmeat < 21, 0.5, 0),
         sc.SD1 = ifelse(sugary_drinks < 250, 0.5, 0),
         sc.SD2 = ifelse(sugary_drinks == 0, 0.5, 0),
         sc.ALC1 = ifelse(alcohol < 14, 0.5, 0),
         sc.ALC2 = ifelse(alcohol == 0, 0.5, 0),
         sc.BFD1 = ifelse(nullipare == 0 & allaitement_dureecum > 0 & allaitement_dureecum < 6, 0.5, 0),
         sc.BFD2 = ifelse(nullipare == 0 & allaitement_dureecum > 6, 0.5, 0),
         # Add up sc.BMI + sc.TT + sc.PA + other recommendations to get score         
         sc.BMI = sc.BMI1 + sc.BMI2, sc.TT = sc.TT1 + sc.TT2, sc.PA = sc.PA1 + sc.PA2,
         sc.FV = sc.FV1 + sc.FV2, sc.TDF = sc.TDF1 + sc.TDF2, sc.UPF= sc.UPF1 + sc.UPF2, sc.MEAT = sc.MEAT1 + sc.MEAT2,
         sc.SD = sc.SD1 + sc.SD2, sc.ALC = sc.ALC1 + sc.ALC2,
         sc.BFD = sc.BFD1 + sc.BFD2,
         # Get overall score
         score = sc.BMI + sc.TT + sc.PA + sc.FV + sc.TDF + sc.UPF + sc.MEAT + sc.SD + sc.ALC + sc.BFD)

df.scoresCS <- clean_dataCS %>% 
  mutate(sc.BMI1 = ifelse(BMI > 18.5 & BMI < 30, 0.25, 0), # At least 0.25 for this condition
         sc.BMI2 = ifelse(BMI > 18.5 & BMI < 25, 0.25, 0), # Another 0.25 for this condition
         sc.TT1  = ifelse(TTAILLE < 88, 0.25, 0), 
         sc.TT2  = ifelse(TTAILLE < 80, 0.25, 0),
         sc.PA1  = ifelse(TotalAPQ3 > 9.375, 0.5, 0), 
         sc.PA2  = ifelse(TotalAPQ3 > 18.75, 0.5, 0),
         sc.FV1 = ifelse(fruitveg > 200, 0.5, 0),
         sc.FV2 = ifelse(fruitveg > 400, 0.5, 0),
         sc.TDF1 = ifelse(TDF > 15, 0.5, 0),
         sc.TDF2 = ifelse(TDF > 30, 0.5, 0),
         sc.UPF1 = ifelse(percent_aUPF < tertile_UPF2_CS, 0.5, 0),
         sc.UPF2 = ifelse(percent_aUPF < tertile_UPF1_CS, 0.5, 0),
         sc.MEAT1 = ifelse(Rmeat < 500 & Pmeat < 100, 0.5, 0),
         sc.MEAT2 = ifelse(Rmeat < 500 & Pmeat < 21, 0.5, 0),
         sc.SD1 = ifelse(sugary_drinks < 250, 0.5, 0),
         sc.SD2 = ifelse(sugary_drinks == 0, 0.5, 0),
         sc.ALC1 = ifelse(alcohol < 14, 0.5, 0),
         sc.ALC2 = ifelse(alcohol == 0, 0.5, 0),
         sc.BFD1 = ifelse(nullipare == 0 & allaitement_dureecum > 0 & allaitement_dureecum < 6, 0.5, 0),
         sc.BFD2 = ifelse(nullipare == 0 & allaitement_dureecum > 6, 0.5, 0),
         # Add up sc.BMI + sc.TT + sc.PA + other recommendations to get score         
         sc.BMI = sc.BMI1 + sc.BMI2, sc.TT = sc.TT1 + sc.TT2, sc.PA = sc.PA1 + sc.PA2,
         sc.FV = sc.FV1 + sc.FV2, sc.TDF = sc.TDF1 + sc.TDF2, sc.UPF= sc.UPF1 + sc.UPF2, sc.MEAT = sc.MEAT1 + sc.MEAT2,
         sc.SD = sc.SD1 + sc.SD2, sc.ALC = sc.ALC1 + sc.ALC2,
         sc.BFD = sc.BFD1 + sc.BFD2,
         # Get overall score
         score = sc.BMI + sc.TT + sc.PA + sc.FV + sc.TDF + sc.UPF + sc.MEAT + sc.SD + sc.ALC + sc.BFD)
```

```{r}
table_scores <- df.scores %>%
  select(CODBMB, CT, BMI,  TTAILLE, TotalAPQ3, fruitveg, TDF, percent_aUPF, Rmeat, Pmeat, sugary_drinks, alcohol, nullipare, allaitement_dureecum, sc.BMI, sc.TT, sc.PA,  sc.FV, sc.TDF, sc.UPF, sc.MEAT, sc.SD, sc.ALC, sc.BFD, score)

table_scoresCTR <- df.scoresCTR %>%
  select(CODBMB, CT, BMI,  TTAILLE, TotalAPQ3, fruitveg, TDF, percent_aUPF, Rmeat, Pmeat, sugary_drinks, alcohol, nullipare, allaitement_dureecum, sc.BMI, sc.TT, sc.PA,  sc.FV, sc.TDF, sc.UPF, sc.MEAT, sc.SD, sc.ALC, sc.BFD, score)

table_scoresCS <- df.scoresCS %>%
  select(CODBMB, CT, BMI,  TTAILLE, TotalAPQ3, fruitveg, TDF, percent_aUPF, Rmeat, Pmeat, sugary_drinks, alcohol, nullipare, allaitement_dureecum, sc.BMI, sc.TT, sc.PA,  sc.FV, sc.TDF, sc.UPF, sc.MEAT, sc.SD, sc.ALC, sc.BFD, score)
```

## Tests de modèles linéaires
```{r}
modele1 <- glm("score ~ BMI +  TTAILLE + TotalAPQ3 + fruitveg +TDF + percent_aUPF + Rmeat + Pmeat + sugary_drinks + alcohol + allaitement_dureecum", data = df.scores)
summary(modele1)
car::Anova(modele1) 
```
Toute autre variable connue par ailleurs, la quantité de viande rouge consommée n'apporte pas significativement de l'information.

```{r}
modele2 <- glm("score ~ BMI + TTAILLE + TotalAPQ3 + fruitveg + TDF + percent_aUPF + Pmeat + sugary_drinks + alcohol + allaitement_dureecum", data = df.scores)
summary(modele2)
car::Anova(modele2)
```
Avec ce modèle, toutes les variables apportent significativement de l'information, toute autre variable connue par ailleurs


## Graphiques et interprétations

Histogrammes des scores dans la cohorte totale, les cas seuls et les témoins seules
```{r}
hist(df.scores$score, xlab = "WCRF/AICR score", main = paste("Scores in the E3N cancer group"))
hist(df.scoresCTR$score, xlab = "WCRF/AICR score", main = paste("Scores in the cases"))
hist(df.scoresCS$score, xlab = "WCRF/AICR score", main = paste("Scores in the controls"))
```

```{r}
scores_fct <- table_scores %>%
  mutate(CT = as.factor(CT), sc.BMI = as.factor(sc.BMI), sc.TT = as.factor(sc.TT),sc.PA = as.factor(sc.PA), sc.FV = as.factor(sc.FV), sc.TDF = as.factor(sc.TDF), sc.UPF = as.factor(sc.UPF), sc.MEAT = as.factor(sc.MEAT), sc.SD = as.factor(sc.SD), sc.ALC = as.factor(sc.ALC), sc.BFD = as.factor(sc.BFD))

scores_fctCS <- table_scoresCS %>%
  mutate(CT = as.factor(CT), sc.BMI = as.factor(sc.BMI), sc.TT = as.factor(sc.TT),sc.PA = as.factor(sc.PA), sc.FV = as.factor(sc.FV), sc.TDF = as.factor(sc.TDF), sc.UPF = as.factor(sc.UPF), sc.MEAT = as.factor(sc.MEAT), sc.SD = as.factor(sc.SD), sc.ALC = as.factor(sc.ALC), sc.BFD = as.factor(sc.BFD))

scores_fctCTR <- table_scoresCTR %>%
  mutate(CT = as.factor(CT), sc.BMI = as.factor(sc.BMI), sc.TT = as.factor(sc.TT),sc.PA = as.factor(sc.PA), sc.FV = as.factor(sc.FV), sc.TDF = as.factor(sc.TDF), sc.UPF = as.factor(sc.UPF), sc.MEAT = as.factor(sc.MEAT), sc.SD = as.factor(sc.SD), sc.ALC = as.factor(sc.ALC), sc.BFD = as.factor(sc.BFD))
```

Comparaison des IMC
```{r}
ggplot(scores_fct) +
  aes (x=score, fill = sc.BMI) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score")

ggplot(scores_fctCTR) +
  aes (x=score, fill = sc.BMI) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score CONTROLS")

ggplot(scores_fctCS) +
  aes (x=score, fill = sc.BMI) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score CASES")
```

Comparaison des aUPF
```{r}
ggplot(scores_fct) +
  aes (x=score, fill = sc.UPF) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score")

ggplot(scores_fctCTR) +
  aes (x=score, fill = sc.UPF) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score CONTROLS")

ggplot(scores_fctCS) +
  aes (x=score, fill = sc.UPF) +
  geom_bar() +
  labs(x = "WCRF/AICR score", fill = "BMI score CASES")

ggplot(scores_fct) +
  aes(x = score, fill = CT) +
  geom_bar(color = "black") +
  facet_grid(sc.UPF ~ .) +
  labs(x = "WCRF/AICR score", y = "Count", title ="scores")
```
# Graphiques jitter points pour avoir une idée des corrélations entre chaque variable et le score (cases + controls)
```{r}
ggplot(df.scores) +
  aes (x=score, y=BMI) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=TTAILLE) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=TotalAPQ3) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=fruitveg) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=TDF) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=Rmeat) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=Pmeat) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=alcohol) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=sugary_drinks) +
  geom_jitter()

ggplot(df.scores) +
  aes (x=score, y=allaitement_dureecum) +
  geom_jitter()
```

```{r}
#df.scores %>%
#  mutate(CT = factor(CT, labels = c("Control", "Case")), 
#         sc.BMI = factor(sc.BMI, labels = "BMI<18.5 or >30", "25<BMI<30", "18.5>BMI>25")) %>%
#  ggplot(scores_fct) +
#  aes (x=score, y=BMI, color = CT) +
#  geom_jitter() +
#  labs(x = "WCRF/AICR score", color = "Status")

ggplot(scores_fct) +
  aes (x=score, y=BMI, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=TTAILLE, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=TotalAPQ3, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=fruitveg, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=TDF, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=percent_aUPF, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=Rmeat, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=Pmeat, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=sugary_drinks, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=alcohol, color = CT) +
  geom_jitter()

ggplot(scores_fct) +
  aes (x=score, y=allaitement_dureecum, color = CT) +
  geom_jitter()
```

Tests/exercices sur le modèle de Cox
```{r}
data("lung")
head(lung)
# univariate cox model
res.cox <- coxph(Surv(time, status) ~ sex, data=lung)
res.cox
summary(res.cox)
# multivariate cox model
multicox <- coxph(Surv(time, status) ~ sex + ph.ecog + wt.loss, data=lung)
summary(multicox)
```